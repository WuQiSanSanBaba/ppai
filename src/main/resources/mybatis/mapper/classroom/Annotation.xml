<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wuqisan.ppat.classroom.mapper.AnnotationMapper">

    <insert id="addAnnotacionList" parameterType="java.util.List">
        INSERT INTO annotation(annotation_id, question_title, question_id, annotation_word,
        annotation_title, content, html, part_id, group_id, classroom_id,
        user_id, user_name, subject_id, subject_name, create_time,
        update_time, create_user, update_user,highlight_flag,highlight_json_array,underline_flag,underline_json_array,categorize,annotation_group_id)
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (#{item.annotationId}, #{item.questionTitle}, #{item.questionId}, #{item.annotationWord},
            #{item.annotationTitle}, #{item.content}, #{item.html}, #{item.partId}, #{item.groupId},
            #{item.classroomId}, #{item.userId}, #{item.userName}, #{item.subjectId}, #{item.subjectName},
            #{item.createTime}, #{item.updateTime}, #{item.createUser}, #{item.updateUser},#{item.highlightFlag},
            #{item.highlightJsonArray}, #{item.underlineFlag},#{item.underlineJsonArray},#{item.categorize},#{item.annotationGroupId})
        </foreach>
    </insert>
    <update id="updateAnnotationByAnnotationId">
        update annotation
        <set>
            <if test="content != null">
                content = #{content},
            </if>
            <if test="html !=null">
                html=#{html},
            </if>
            <if test="underlineFlag !=null">
                underline_flag=#{underlineFlag},
            </if>
            <if test="underlineJsonArray !=null">
                underline_json_array=#{underlineJsonArray},
            </if>
            <if test="highlightFlag !=null">
                highlight_flag=#{highlightFlag},
            </if>
            <if test="highlightJsonArray !=null">
                highlight_json_array=#{highlightJsonArray},
            </if>
        </set>
        where annotation_id = #{annotationId}
    </update>
    <select id="getAnnotationByQuestionId" resultType="com.wuqisan.ppat.classroom.bean.Annotation">
        SELECT
            annotation_id,
            question_title,
            question_id,
            annotation_word,
            annotation_title,
            content,
            html,
            part_id,
            group_id,
            classroom_id,
            user_id,
            user_name,
            subject_id,
            subject_name,
            create_time,
            update_time,
            create_user,
            update_user,
            highlight_flag,
            underline_flag,
            highlight_json_array,
            underline_json_array,
            categorize,
            annotation_group_id
        FROM
            annotation
        where question_id=#{questionId}
    </select>
    <select id="getAnnotationByAnnotationGroupId" resultType="com.wuqisan.ppat.classroom.bean.Annotation">
        SELECT annotation_id,
               question_title,
               question_id,
               annotation_word,
               annotation_title,
               content,
               html,
               part_id,
               group_id,
               classroom_id,
               user_id,
               user_name,
               subject_id,
               subject_name,
               create_time,
               update_time,
               create_user,
               update_user,
               highlight_flag,
               underline_flag,
               highlight_json_array,
               underline_json_array,
               categorize,
               annotation_group_id
        FROM annotation
        where annotation_group_id = #{annotationGroupId}
    </select>
    <select id="getAnnotationListBySubjectId" resultType="com.wuqisan.ppat.classroom.bean.Annotation">
        SELECT annotation_id,
               question_title,
               question_id,
               annotation_word,
               annotation_title,
               content,
               html,
               part_id,
               group_id,
               classroom_id,
               user_id,
               user_name,
               subject_id,
               subject_name,
               create_time,
               update_time,
               create_user,
               update_user,
               highlight_flag,
               underline_flag,
               highlight_json_array,
               underline_json_array,
               categorize,
               annotation_group_id
        FROM annotation
        where group_id = #{groupId}
        and subject_id = #{subjectId}
    </select>
</mapper>